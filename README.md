# Мини-банковская система

## Описание проекта
Проект представляет собой упрощённую мини-версию банковской системы, которая позволяет:

- Управлять клиентами, счетами и логами транзакций
- Добавлять и удалять банки
- Блокировать и разблокировать счета

## UML-диаграммы

### Диаграмма последовательности: Процесс открытия счёта
Показывает последовательность действий при открытии счёта.  
![Диаграмма последовательности: Открытие счёта](Sequence%20Diagram%20(2)-1.jpeg)

### Диаграмма последовательности: Процесс перевода на другой банк
Описывает процесс перевода средств в другой банк (не реализовано).  
![Диаграмма последовательности: Перевод](Sequence%20Diagram3-1.jpeg)

### Диаграмма классов: Архитектура проекта
Отражает ключевые сущности, их атрибуты, методы и взаимосвязи.  
![Диаграмма классов](Class%20Diagram1%20(2).jpeg)

Демонстрация работы программы
![Screenshot_7](https://github.com/user-attachments/assets/47c15551-95aa-4f15-a54e-a28cb3b52cca)
[ Основной интерфейс программы ]

#### Менеджер

![Screenshot_3](https://github.com/user-attachments/assets/d7ffb985-101e-4987-a898-346afb9109c3)
[ Интерфейс Менеджера ]

![Screenshot_6](https://github.com/user-attachments/assets/25770d44-d8bc-4553-9c48-08d286e12b31)
[ Добавление банка ]

![Screenshot_8](https://github.com/user-attachments/assets/d8ec1f13-f11d-4e2a-9291-bd7a2a8da1b8)
[ Успешное удаление банка ]

![Screenshot_9](https://github.com/user-attachments/assets/06cd8435-f389-4544-8b3f-5eaf4f0266e9)
[ Неудачное удаление банка ]

![Screenshot_4](https://github.com/user-attachments/assets/1fe4bbc5-cbf9-4921-9162-25101d8807c8)
[ Просмотр всех клиентов ]

#### Администратор

![Screenshot_10](https://github.com/user-attachments/assets/fa36c8a0-0a49-4626-a41b-ed19b67acd7c)
[ Интерфейс Администратора ]

![Screenshot_12](https://github.com/user-attachments/assets/afd6fafa-7b92-411c-bacb-c2fb65747fbd)
[ Пример блокировки (У счёта появляется статус "frozen") ]

Админ может делать все действия, что и менеджер, но ему также доступно блокировка / разблокировка счёта.

#### Клиент

![Screenshot_1](https://github.com/user-attachments/assets/aac5e967-2e14-4b6c-852e-de08d6fcedde)
[ Пройденная регистрация и интерфейс клиента ]

![Screenshot_2](https://github.com/user-attachments/assets/f5f2f113-a624-400a-83cc-532328e1d8bf)
[ Пример не пройденной регистрации (Возраст должны быть >= 18)]

![Screenshot_11](https://github.com/user-attachments/assets/00b565c1-916c-4421-9c11-cc6ebb278733)
[ Просмотр всех счетов (Ищет по связке clientid + accountid )]

# Этап 1. Проектирование системы
## Какую проблему решает?
Система решает проблему управления банковскими продуктами, клиентами и их данными.

## Какие ключевые функции предоставляет?
- **Управление клиентами**: регистрация и хранение данных клиентов
- **Управление счетами**: создание, обслуживание, начисление процентов и комиссий
- **Администрирование**: управление банками, контроль доступа менеджеров

## Какие диаграммы выбраны и почему?
### Диаграмма последовательности
Показывает, как объекты взаимодействуют друг с другом в определённых сценариях (например, при открытии счёта или переводе денег).

### Диаграмма классов
Отображает ключевые сущности системы, их атрибуты, методы и взаимосвязи, помогая понять статическую структуру проекта.

## Как диаграммы помогают понять архитектуру приложения?
- **Диаграмма последовательности**: демонстрирует динамическое поведение системы, показывая последовательность шагов в сценариях, таких как перевод денег
- **Диаграмма классов**: помогает понять организацию элементов кода, их связи и роли в системе


# Этап 2. База данных банковской системы

База данных предназначена для управления клиентами, счетами, транзакциями и сотрудниками.  
**СУБД:** PostgreSQL  

## Таблицы

- **Admin**: учётные данные администраторов системы.  
- **Bank**: информация о банках и их тарифах (ставки по депозитам/кредитам).  
- **Manager**: данные менеджеров банка с уровнями доступа.  
- **Client**: персональные данные клиентов.  
- **Account**: базовые данные о счетах (дебетовых, депозитных, кредитных).  
- **DebitAccount**: дополнительные параметры дебетовых счетов.  
- **DepositAccount**: дополнительные параметры депозитных счетов.  
- **CreditAccount**: дополнительные параметры кредитных счетов.  
- **Transaction**: история всех финансовых операций.  
- **ManagerClient**: связь "многие ко многим" между менеджерами и клиентами.  

## Виды связей

### 1 к 1:
- **Account** (базовый класс) → **DebitAccount**, **CreditAccount**, **DepositAccount**.  

### 1 ко многим:
- **Client** → **Account** (у одного клиента может быть несколько счетов).  
- **Bank** → **Manager** (у одного банка может быть несколько менеджеров).  
- **Bank** → **Client** (у одного банка может быть несколько клиентов).  

## Ключи

- **Primary Key:**  
  `AdminId`, `ClientId`, `BankId`, `AccountId` и т.д.  

- **Foreign Key:**  
  - `ClientId` в таблице **Account**.  
  - `BankId` в таблице **Manager**.  

- **Unique-поля:**  
  `EmailAdmin`, `PassportNumber`, `PassportSeries` и т.д.  

# Этап 3. Основные команды

## BankService

- `AddBankAsync`: добавляет новый банк в таблицу `bank`.
- `DeleteBankAsync`: удаляет банк из базы данных, если с ним не связаны клиенты или менеджеры.
- `GetBankByIdAsync`: получает информацию о банке по его ID.
- `GetAllBanksAsync`: возвращает список всех банков.

## ClientService

- `RegisterClientAsync`: регистрирует нового клиента в таблице `client`.
- `GetClientByIdAsync`: получает информацию о клиенте по его ID.
- `GetAllClientsAsync`: возвращает список всех клиентов.

## AccountService

- `CreateAccountAsync`: создаёт новый счёт (дебетовый, кредитный или депозитный).
- `BlockAccountAsync`: блокирует счёт по ID (устанавливает статус `frozen`).
- `UnblockAccountAsync`: разблокирует счёт по ID (устанавливает статус `active`).
- `DepositMoneyAsync`: пополняет баланс счёта и создаёт запись о транзакции.
- `WithdrawMoneyAsync`: снимает средства со счёта (если достаточно баланса) и создаёт запись о транзакции.
- `GetAccountByIdAsync`: получает информацию о счёте по его ID.
- `GetClientAccountsAsync`: возвращает список всех счетов клиента.

# Этап 4. Структура слоя работы с базой данных

## Сервисы

### BankService
Работает с таблицей `bank`. Предоставляет методы для:
- Добавления банков.
- Удаления банков.
- Получения информации о банках.

### ClientService
Работает с таблицей `client`. Предоставляет методы для:
- Регистрации клиентов.
- Получения информации о клиентах.

### AccountService
Работает с таблицами:
- `account` (основная таблица счетов).
- `debitAccount` (дебетовые счета).
- `depositAccount` (депозитные счета).
- `creditAccount` (кредитные счета).

Предоставляет методы для:
- Создания счетов.
- Блокировки/разблокировки счетов.
- Пополнения/снятия средств.

## Модели

### Bank
Свойства: `BankId`, `Name`, `DepositRate`, `CreditFee`, `CreatedAt`, `UpdatedAt`.

### Client
Свойства: `ClientId`, `FirstName`, `LastName`, `Age`, `Address`, `PassportSeries`, `PassportNumber`, `BankId`, `CreatedAt`, `UpdatedAt`.

### Account
Свойства: `AccountId`, `ClientId`, `Balance`, `InterestRate`, `AccountType`, `Status`, `CreatedAt`, `UpdatedAt`.

## Подключение к базе данных
Используется библиотека `Npgsql` для работы с PostgreSQL.

Строка подключения:
```
Host=localhost;Port=5432;Database=postgres;Username=postgres;Password=password;
```
### Все методы сервисов асинхронные (async/await) для оптимизации обращений к базе данных.

#### Асинхронные операции обеспечивают высокую производительность и отзывчивость банковской системы,   позволяя обрабатывать множество одновременных запросов без блокировки потоков. Это важно для стабильной работы приложения под нагрузкой. 

# Этап 5. Реализация бизнес-слоя

Реализован бизнес-слой банковской системы, который обеспечивает основную логику приложения, отделенную от слоя представления и работы с БД.

## Ключевые компоненты

### Сервисы

**BankService** - управление банками:
- Добавление/удаление банков
- Получение информации о банках

**ClientService** - управление клиентами:
- Регистрация новых клиентов
- Получение информации о клиентах

**AccountService** - управление счетами:
- Создание счетов разных типов (дебетовый, кредитный, депозитный)
- Блокировка/разблокировка счетов
- Операции пополнения и снятия средств

## Основные принципы реализации
- Четкое разделение слоев (бизнес-логика, представление, доступ к данным)
- Использование интерфейсов для сервисов
- Асинхронные операции для работы с БД
- Обработка ошибок и проверка условий

## Особенности бизнес-логики
- Валидация операций (проверка достаточности средств, статуса счета)
- Разные права доступа для клиентов, менеджеров и администраторов
- Автоматическое создание связанных записей при открытии счетов
- Ограничения на удаление банков с привязанными клиентами


