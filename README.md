# Мини-банковская система

## Описание проекта
Проект представляет собой упрощённую мини-версию банковской системы, которая позволяет:

- Управлять клиентами, счетами и логами транзакций
- Добавлять и удалять банки
- Блокировать и разблокировать счета

## UML-диаграммы

### Диаграмма последовательности: Процесс открытия счёта
Показывает последовательность действий при открытии счёта.  
![Диаграмма последовательности: Открытие счёта](Sequence%20Diagram%20(2)-1.jpeg)

### Диаграмма последовательности: Процесс перевода на другой банк
Описывает процесс перевода средств в другой банк (не реализовано).  
![Диаграмма последовательности: Перевод](Sequence%20Diagram3-1.jpeg)

### Диаграмма классов: Архитектура проекта
Отражает ключевые сущности, их атрибуты, методы и взаимосвязи.  
![Диаграмма классов](Class%20Diagram1%20(2).jpeg)

# Этап 1. Проектирование системы
## Какую проблему решает?
Система решает проблему управления банковскими продуктами, клиентами и их данными.

## Какие ключевые функции предоставляет?
- **Управление клиентами**: регистрация и хранение данных клиентов
- **Управление счетами**: создание, обслуживание, начисление процентов и комиссий
- **Администрирование**: управление банками, контроль доступа менеджеров

## Какие диаграммы выбраны и почему?
### Диаграмма последовательности
Показывает, как объекты взаимодействуют друг с другом в определённых сценариях (например, при открытии счёта или переводе денег).

### Диаграмма классов
Отображает ключевые сущности системы, их атрибуты, методы и взаимосвязи, помогая понять статическую структуру проекта.

## Как диаграммы помогают понять архитектуру приложения?
- **Диаграмма последовательности**: демонстрирует динамическое поведение системы, показывая последовательность шагов в сценариях, таких как перевод денег
- **Диаграмма классов**: помогает понять организацию элементов кода, их связи и роли в системе


# Этап 2. База данных банковской системы

База данных предназначена для управления клиентами, счетами, транзакциями и сотрудниками.  
**СУБД:** PostgreSQL  

## Таблицы

- **Admin**: учётные данные администраторов системы.  
- **Bank**: информация о банках и их тарифах (ставки по депозитам/кредитам).  
- **Manager**: данные менеджеров банка с уровнями доступа.  
- **Client**: персональные данные клиентов.  
- **Account**: базовые данные о счетах (дебетовых, депозитных, кредитных).  
- **DebitAccount**: дополнительные параметры дебетовых счетов.  
- **DepositAccount**: дополнительные параметры депозитных счетов.  
- **CreditAccount**: дополнительные параметры кредитных счетов.  
- **Transaction**: история всех финансовых операций.  
- **ManagerClient**: связь "многие ко многим" между менеджерами и клиентами.  

## Виды связей

### 1 к 1:
- **Account** (базовый класс) → **DebitAccount**, **CreditAccount**, **DepositAccount**.  

### 1 ко многим:
- **Client** → **Account** (у одного клиента может быть несколько счетов).  
- **Bank** → **Manager** (у одного банка может быть несколько менеджеров).  
- **Bank** → **Client** (у одного банка может быть несколько клиентов).  

## Ключи

- **Primary Key:**  
  `AdminId`, `ClientId`, `BankId`, `AccountId` и т.д.  

- **Foreign Key:**  
  - `ClientId` в таблице **Account**.  
  - `BankId` в таблице **Manager**.  

- **Unique-поля:**  
  `EmailAdmin`, `PassportNumber`, `PassportSeries` и т.д.  

# Этап 3. Основные команды

## BankService

- `AddBankAsync`: добавляет новый банк в таблицу `bank`.
- `DeleteBankAsync`: удаляет банк из базы данных, если с ним не связаны клиенты или менеджеры.
- `GetBankByIdAsync`: получает информацию о банке по его ID.
- `GetAllBanksAsync`: возвращает список всех банков.

## ClientService

- `RegisterClientAsync`: регистрирует нового клиента в таблице `client`.
- `GetClientByIdAsync`: получает информацию о клиенте по его ID.
- `GetAllClientsAsync`: возвращает список всех клиентов.

## AccountService

- `CreateAccountAsync`: создаёт новый счёт (дебетовый, кредитный или депозитный).
- `BlockAccountAsync`: блокирует счёт по ID (устанавливает статус `frozen`).
- `UnblockAccountAsync`: разблокирует счёт по ID (устанавливает статус `active`).
- `DepositMoneyAsync`: пополняет баланс счёта и создаёт запись о транзакции.
- `WithdrawMoneyAsync`: снимает средства со счёта (если достаточно баланса) и создаёт запись о транзакции.
- `GetAccountByIdAsync`: получает информацию о счёте по его ID.
- `GetClientAccountsAsync`: возвращает список всех счетов клиента.

# Этап 4. Структура слоя работы с базой данных

## Сервисы

### BankService
Работает с таблицей `bank`. Предоставляет методы для:
- Добавления банков.
- Удаления банков.
- Получения информации о банках.

### ClientService
Работает с таблицей `client`. Предоставляет методы для:
- Регистрации клиентов.
- Получения информации о клиентах.

### AccountService
Работает с таблицами:
- `account` (основная таблица счетов).
- `debitAccount` (дебетовые счета).
- `depositAccount` (депозитные счета).
- `creditAccount` (кредитные счета).

Предоставляет методы для:
- Создания счетов.
- Блокировки/разблокировки счетов.
- Пополнения/снятия средств.

## Модели

### Bank
Свойства: `BankId`, `Name`, `DepositRate`, `CreditFee`, `CreatedAt`, `UpdatedAt`.

### Client
Свойства: `ClientId`, `FirstName`, `LastName`, `Age`, `Address`, `PassportSeries`, `PassportNumber`, `BankId`, `CreatedAt`, `UpdatedAt`.

### Account
Свойства: `AccountId`, `ClientId`, `Balance`, `InterestRate`, `AccountType`, `Status`, `CreatedAt`, `UpdatedAt`.

## Подключение к базе данных
Используется библиотека `Npgsql` для работы с PostgreSQL.

Строка подключения:
```
Host=localhost;Port=5432;Database=postgres;Username=postgres;Password=password;
```
### Все методы сервисов асинхронные (async/await) для оптимизации обращений к базе данных.

[#### Асинхронные операции обеспечивают высокую производительность и отзывчивость банковской системы,   позволяя обрабатывать множество одновременных запросов без блокировки потоков. Это критически важно для стабильной работы приложения под нагрузкой, особенно при частых операциях с базой данных.]

Этап 5. Реализация бизнес-слоя
Реализован бизнес-слой банковской системы, который обеспечивает основную логику приложения, отделенную от слоя представления и работы с БД.

Ключевые компоненты
Сервисы
BankService - управление банками:

Добавление/удаление банков

Получение информации о банках

ClientService - управление клиентами:

Регистрация новых клиентов

Получение информации о клиентах

AccountService - управление счетами:

Создание счетов разных типов (дебетовый, кредитный, депозитный)

Блокировка/разблокировка счетов

Операции пополнения и снятия средств

Основные принципы реализации
Четкое разделение слоев (бизнес-логика, представление, доступ к данным)

Использование интерфейсов для сервисов

Асинхронные операции для работы с БД

Обработка ошибок и проверка условий

Особенности бизнес-логики
Валидация операций (проверка достаточности средств, статуса счета)

Разные права доступа для клиентов, менеджеров и администраторов

Автоматическое создание связанных записей при открытии счетов

Ограничения на удаление банков с привязанными клиентами



